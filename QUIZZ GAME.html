<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –í–∏–∫—Ç–æ—Ä–∏–Ω–∞</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
            --background: #1a1a2e;
            --card-bg: #16213e;
            --text: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px var(--primary); }
            50% { box-shadow: 0 0 20px var(--primary); }
            100% { box-shadow: 0 0 5px var(--primary); }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease-out;
            min-height: 100vh;
            padding: 20px;
        }

        .screen.active {
            display: block;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-info {
            background: var(--info);
        }

        .btn-large {
            padding: 15px 30px;
            font-size: 18px;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        h1, h2, h3 {
            margin-bottom: 20px;
            text-align: center;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞ */
        .tv-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .room-code {
            font-size: 3rem;
            font-weight: bold;
            letter-spacing: 10px;
            margin: 30px 0;
            background: linear-gradient(45deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite;
        }

        .qr-container {
            display: inline-block;
            padding: 20px;
            background: white;
            border-radius: 15px;
            margin: 20px 0;
            animation: glow 2s infinite;
        }

        .players-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }

        .player-badge {
            background: var(--primary);
            padding: 10px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.5s ease-out;
        }

        .player-badge.host::after {
            content: "üëë";
        }

        .timer {
            font-size: 4rem;
            font-weight: bold;
            margin: 20px 0;
            color: var(--warning);
            animation: pulse 1s infinite;
        }

        .question-container {
            margin: 30px 0;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-text {
            font-size: 2rem;
            line-height: 1.4;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
        }

        .answer-option {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-align: center;
            font-size: 1.2rem;
        }

        .answer-option:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }

        .answer-option.selected {
            background: var(--primary);
            animation: pulse 0.5s;
        }

        .answer-option.correct {
            background: var(--success);
            animation: pulse 0.5s;
        }

        .answer-option.incorrect {
            background: var(--danger);
        }

        .order-answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .order-item {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            cursor: move;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .order-item:hover {
            border-color: var(--primary);
        }

        .order-item.dragging {
            opacity: 0.5;
        }

        .text-answer {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid var(--primary);
            background: var(--card-bg);
            color: var(--text);
            font-size: 1.2rem;
            margin: 20px 0;
        }

        .plus-two-btn {
            background: var(--warning);
            margin-left: 10px;
        }

        .plus-two-btn.active {
            background: var(--danger);
            animation: pulse 1s infinite;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
        }

        .results-table th, .results-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .results-table tr:first-child {
            background: linear-gradient(45deg, var(--warning), var(--danger));
            font-size: 1.2rem;
        }

        .results-table tr:nth-child(2) {
            background: rgba(255, 255, 255, 0.1);
        }

        .results-table tr:nth-child(3) {
            background: rgba(255, 255, 255, 0.05);
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--primary);
            top: -10px;
            animation: confetti 5s linear forwards;
            z-index: 1000;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ */
        .phone-screen {
            text-align: center;
        }

        .remote-control {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 30px 0;
        }

        .remote-btn {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .remote-btn:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .remote-btn i {
            font-size: 1.5rem;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .answers-grid {
                grid-template-columns: 1fr;
            }
            
            .remote-control {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .question-text {
                font-size: 1.5rem;
            }
            
            .room-code {
                font-size: 2rem;
            }
            
            .timer {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞ -->
    <div id="tv-screen" class="screen tv-screen">
        <div class="container">
            <h1>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h1>
            
            <div id="room-creation" class="card">
                <h2>–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</h2>
                <div class="room-code" id="room-code">XXXX</div>
                <p>–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–≤ QR-–∫–æ–¥</p>
                <div class="qr-container">
                    <canvas id="qr-code"></canvas>
                </div>
                <div class="players-list" id="players-list">
                    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
                <button id="start-quiz-btn" class="btn btn-large btn-success" disabled>–ù–∞—á–∞—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É</button>
            </div>
            
            <div id="quiz-selection" class="card" style="display: none;">
                <h2>–í—ã–±–æ—Ä –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã</h2>
                <div id="quiz-list">
                    <!-- –°–ø–∏—Å–æ–∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div id="game-screen" class="card" style="display: none;">
                <h2 id="round-title">–†–∞—É–Ω–¥ 1</h2>
                <div class="question-container">
                    <div class="question-text" id="question-text">–í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç –∑–¥–µ—Å—å</div>
                </div>
                <div class="timer" id="timer">30</div>
                <div id="answers-container">
                    <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                <div id="correct-answer" style="display: none;">
                    <h3>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</h3>
                    <div id="correct-answer-text"></div>
                </div>
                <button id="next-question-btn" class="btn btn-large btn-info" style="display: none;">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å</button>
            </div>
            
            <div id="results-screen" class="card" style="display: none;">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã</h2>
                <table class="results-table" id="results-table">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </table>
                <button id="play-again-btn" class="btn btn-large btn-success">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
    <div id="phone-screen" class="screen phone-screen">
        <div class="container">
            <h1>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h1>
            
            <div id="phone-connect" class="card">
                <h2>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ</h2>
                <input type="text" id="room-code-input" placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã" class="text-answer">
                <button id="connect-btn" class="btn btn-large btn-block">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
            </div>
            
            <div id="phone-waiting" class="card" style="display: none;">
                <h2>–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞</h2>
                <p>–û–∂–∏–¥–∞–π—Ç–µ, –ø–æ–∫–∞ —Ö–æ—Å—Ç –Ω–∞—á–Ω–µ—Ç –≤–∏–∫—Ç–æ—Ä–∏–Ω—É</p>
                <div class="players-list" id="phone-players-list">
                    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div id="remote-control" class="card" style="display: none;">
                <h2>–ü—É–ª—å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
                <p>–í—ã - —Ö–æ—Å—Ç –∫–æ–º–Ω–∞—Ç—ã</p>
                <div class="remote-control">
                    <div class="remote-btn" id="start-quiz-remote">
                        <i>‚ñ∂Ô∏è</i>
                        <span>–ù–∞—á–∞—Ç—å</span>
                    </div>
                    <div class="remote-btn" id="next-question-remote">
                        <i>‚è≠Ô∏è</i>
                        <span>–°–ª–µ–¥—É—é—â–∏–π</span>
                    </div>
                    <div class="remote-btn" id="show-results-remote">
                        <i>üèÜ</i>
                        <span>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</span>
                    </div>
                </div>
            </div>
            
            <div id="phone-game" class="card" style="display: none;">
                <h2 id="phone-round-title">–†–∞—É–Ω–¥ 1</h2>
                <div class="question-text" id="phone-question-text">–í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç –∑–¥–µ—Å—å</div>
                <div class="timer" id="phone-timer">30</div>
                <div id="phone-answers-container">
                    <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                <div id="phone-text-answer-container" style="display: none;">
                    <input type="text" id="phone-text-answer" class="text-answer" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                    <button id="phone-submit-answer" class="btn btn-block">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    <button id="phone-plus-two" class="btn plus-two-btn">+2</button>
                </div>
                <div id="phone-answer-status"></div>
            </div>
            
            <div id="phone-results" class="card" style="display: none;">
                <h2>–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
                <div id="phone-player-score" class="room-code">0</div>
                <p>–û—á–∫–∏</p>
                <table class="results-table" id="phone-results-table">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </table>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let socket = null;
        let isHost = false;
        let playerId = null;
        let roomCode = null;
        let currentQuestion = null;
        let selectedAnswer = null;
        let timerInterval = null;
        let timeLeft = 0;
        let playerScore = 0;
        let players = {};
        let currentRound = 0;
        let currentQuestionIndex = 0;
        let quizzes = [];
        let selectedQuiz = null;
        let gameState = 'waiting'; // waiting, quiz-selection, playing, results
        let plusTwoActive = false;
        let answerSubmitted = false;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —Ç–µ–ª–µ–≤–∏–∑–æ—Ä —ç—Ç–æ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
            const isTV = window.innerWidth > 768;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get('room');
            
            if (roomParam) {
                // –ï—Å–ª–∏ –≤ URL –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä room, –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ
                roomCode = roomParam;
                playerId = generatePlayerId();
                isHost = false;
                
                document.getElementById('phone-screen').classList.add('active');
                document.getElementById('phone-connect').style.display = 'none';
                document.getElementById('phone-waiting').style.display = 'block';
                
                addPlayer(playerId, "–ò–≥—Ä–æ–∫ " + (Object.keys(players).length + 1), isHost);
                updatePhonePlayersList();
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
                simulateConnectionToRoom(roomCode);
            } else if (isTV) {
                // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä, —Å–æ–∑–¥–∞–µ–º –∫–æ–º–Ω–∞—Ç—É
                document.getElementById('tv-screen').classList.add('active');
                initializeTV();
            } else {
                // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ room, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                document.getElementById('phone-screen').classList.add('active');
                initializePhone();
            }
            
            // –ò–º–∏—Ç–∞—Ü–∏—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π WebSocket)
            initializeMockSocket();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            loadQuizzes();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞
        function initializeTV() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∫–æ–º–Ω–∞—Ç—ã
            roomCode = generateRoomCode();
            document.getElementById('room-code').textContent = roomCode;
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–∞ —Å URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            const currentUrl = window.location.origin + window.location.pathname;
            const connectUrl = `${currentUrl}?room=${roomCode}`;
            generateQRCode(connectUrl);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('start-quiz-btn').addEventListener('click', startQuiz);
            document.getElementById('next-question-btn').addEventListener('click', nextQuestion);
            document.getElementById('play-again-btn').addEventListener('click', resetGame);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ö–æ—Å—Ç–∞ –≤ —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
            playerId = generatePlayerId();
            isHost = true;
            addPlayer(playerId, "–•–æ—Å—Ç", true);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        function initializePhone() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('connect-btn').addEventListener('click', connectToRoom);
            document.getElementById('start-quiz-remote').addEventListener('click', startQuizFromRemote);
            document.getElementById('next-question-remote').addEventListener('click', nextQuestionFromRemote);
            document.getElementById('show-results-remote').addEventListener('click', showResultsFromRemote);
            document.getElementById('phone-submit-answer').addEventListener('click', submitTextAnswer);
            document.getElementById('phone-plus-two').addEventListener('click', togglePlusTwo);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∫–æ–º–Ω–∞—Ç—ã
        function generateRoomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–∞
        function generateQRCode(text) {
            const typeNumber = 0;
            const errorCorrectionLevel = 'L';
            const qr = qrcode(typeNumber, errorCorrectionLevel);
            qr.addData(text);
            qr.make();
            
            const canvas = document.getElementById('qr-code');
            const ctx = canvas.getContext('2d');
            const moduleCount = qr.getModuleCount();
            const cellSize = 5;
            const size = moduleCount * cellSize;
            
            canvas.width = size;
            canvas.height = size;
            canvas.style.width = size + 'px';
            canvas.style.height = size + 'px';
            
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, size, size);
            
            ctx.fillStyle = '#000000';
            for (let row = 0; row < moduleCount; row++) {
                for (let col = 0; col < moduleCount; col++) {
                    if (qr.isDark(row, col)) {
                        ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                    }
                }
            }
        }

        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
        function simulateConnectionToRoom(code) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É
            console.log(`–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ ${code}`);
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            setTimeout(() => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–µ—Ä–≤—ã–π –ª–∏ —ç—Ç–æ –∏–≥—Ä–æ–∫ (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ—Å—Ç–æ–º)
                if (Object.keys(players).length === 1) {
                    isHost = true;
                    document.getElementById('remote-control').style.display = 'block';
                    document.getElementById('phone-waiting').style.display = 'none';
                }
            }, 1000);
        }

        // –ò–º–∏—Ç–∞—Ü–∏—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        function initializeMockSocket() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É
            console.log("–ò–º–∏—Ç–∞—Ü–∏—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è");
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
            setInterval(() => {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            }, 100);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–∏–∫—Ç–æ—Ä–∏–Ω
        function loadQuizzes() {
            // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω
            quizzes = [
                {
                    id: 1,
                    title: "–û–±—â–∞—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞",
                    rounds: [
                        {
                            type: "multiple-choice",
                            questions: [
                                {
                                    question: "–ö–∞–∫–∞—è –ø–ª–∞–Ω–µ—Ç–∞ —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –≤ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ?",
                                    answers: ["–ó–µ–º–ª—è", "–ú–∞—Ä—Å", "–Æ–ø–∏—Ç–µ—Ä", "–°–∞—Ç—É—Ä–Ω"],
                                    correct: 2,
                                    time: 30
                                },
                                {
                                    question: "–°–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ –ó–µ–º–ª–µ?",
                                    answers: ["5", "6", "7", "8"],
                                    correct: 2,
                                    time: 20
                                },
                                {
                                    question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª '–í–æ–π–Ω—É –∏ –º–∏—Ä'?",
                                    answers: ["–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–¢–æ–ª—Å—Ç–æ–π", "–ß–µ—Ö–æ–≤", "–¢—É—Ä–≥–µ–Ω–µ–≤"],
                                    correct: 1,
                                    time: 25
                                },
                                {
                                    question: "–ö–∞–∫–æ–π —Ö–∏–º–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è –∫–∞–∫ 'Au'?",
                                    answers: ["–°–µ—Ä–µ–±—Ä–æ", "–ñ–µ–ª–µ–∑–æ", "–ó–æ–ª–æ—Ç–æ", "–ê–ª—é–º–∏–Ω–∏–π"],
                                    correct: 2,
                                    time: 15
                                },
                                {
                                    question: "–ö–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º –†–æ—Å—Å–∏–∏?",
                                    answers: ["–ú–µ–¥–≤–µ–¥—å", "–û—Ä–µ–ª", "–í–æ–ª–∫", "–¢–∏–≥—Ä"],
                                    correct: 0,
                                    time: 20
                                },
                                {
                                    question: "–°–∫–æ–ª—å–∫–æ —Ü–≤–µ—Ç–æ–≤ –≤ —Ä–∞–¥—É–≥–µ?",
                                    answers: ["5", "6", "7", "8"],
                                    correct: 2,
                                    time: 15
                                }
                            ]
                        },
                        {
                            type: "ordering",
                            questions: [
                                {
                                    question: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ –ø–ª–∞–Ω–µ—Ç—ã –ø–æ –ø–æ—Ä—è–¥–∫—É –æ—Ç –°–æ–ª–Ω—Ü–∞",
                                    answers: ["–ó–µ–º–ª—è", "–í–µ–Ω–µ—Ä–∞", "–ú–∞—Ä—Å", "–ú–µ—Ä–∫—É—Ä–∏–π"],
                                    correctOrder: [3, 1, 0, 2],
                                    time: 45
                                },
                                {
                                    question: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ –æ–∫–µ–∞–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é –ø–ª–æ—â–∞–¥–∏",
                                    answers: ["–ê—Ç–ª–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π", "–¢–∏—Ö–∏–π", "–ò–Ω–¥–∏–π—Å–∫–∏–π", "–°–µ–≤–µ—Ä–Ω—ã–π –õ–µ–¥–æ–≤–∏—Ç—ã–π"],
                                    correctOrder: [1, 0, 2, 3],
                                    time: 40
                                },
                                {
                                    question: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –∞—Ç–æ–º–Ω–æ–º—É –Ω–æ–º–µ—Ä—É",
                                    answers: ["–ö–∏—Å–ª–æ—Ä–æ–¥", "–í–æ–¥–æ—Ä–æ–¥", "–£–≥–ª–µ—Ä–æ–¥", "–ê–∑–æ—Ç"],
                                    correctOrder: [1, 2, 3, 0],
                                    time: 35
                                }
                            ]
                        },
                        {
                            type: "text-answer",
                            questions: [
                                {
                                    question: "–°—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏?",
                                    correctAnswer: "–ü–∞—Ä–∏–∂",
                                    time: 20
                                },
                                {
                                    question: "–°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –≥–æ—Ä–∞ –≤ –º–∏—Ä–µ?",
                                    correctAnswer: "–≠–≤–µ—Ä–µ—Å—Ç",
                                    time: 25
                                },
                                {
                                    question: "–°–∫–æ–ª—å–∫–æ –ª–µ—Ç –¥–ª–∏–ª–∞—Å—å –°—Ç–æ–ª–µ—Ç–Ω—è—è –≤–æ–π–Ω–∞?",
                                    correctAnswer: "116",
                                    time: 30
                                }
                            ]
                        }
                    ]
                }
            ];
        }

        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        function connectToRoom() {
            const code = document.getElementById('room-code-input').value.toUpperCase();
            if (code.length !== 4) {
                alert("–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 4 —Å–∏–º–≤–æ–ª–æ–≤");
                return;
            }
            
            roomCode = code;
            playerId = generatePlayerId();
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
            document.getElementById('phone-connect').style.display = 'none';
            document.getElementById('phone-waiting').style.display = 'block';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ —Å–ø–∏—Å–æ–∫
            addPlayer(playerId, "–ò–≥—Ä–æ–∫ " + (Object.keys(players).length + 1), isHost);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
            updatePhonePlayersList();
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            simulateConnectionToRoom(roomCode);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –∏–≥—Ä–æ–∫–∞
        function generatePlayerId() {
            return 'player_' + Math.random().toString(36).substr(2, 9);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
        function addPlayer(id, name, host = false) {
            players[id] = {
                id: id,
                name: name,
                host: host,
                score: 0,
                answered: false,
                answer: null,
                correct: false
            };
            
            updatePlayersList();
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Å—Ç—ã, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞—á–∞–ª–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
            if (isHost) {
                document.getElementById('start-quiz-btn').disabled = false;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–µ
        function updatePlayersList() {
            const playersList = document.getElementById('players-list');
            playersList.innerHTML = '';
            
            Object.values(players).forEach(player => {
                const playerBadge = document.createElement('div');
                playerBadge.className = 'player-badge' + (player.host ? ' host' : '');
                playerBadge.textContent = player.name;
                playersList.appendChild(playerBadge);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
        function updatePhonePlayersList() {
            const playersList = document.getElementById('phone-players-list');
            playersList.innerHTML = '';
            
            Object.values(players).forEach(player => {
                const playerBadge = document.createElement('div');
                playerBadge.className = 'player-badge' + (player.host ? ' host' : '');
                playerBadge.textContent = player.name;
                playersList.appendChild(playerBadge);
            });
        }

        // –ù–∞—á–∞–ª–æ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
        function startQuiz() {
            document.getElementById('room-creation').style.display = 'none';
            document.getElementById('quiz-selection').style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω
            const quizList = document.getElementById('quiz-list');
            quizList.innerHTML = '';
            
            quizzes.forEach(quiz => {
                const quizButton = document.createElement('button');
                quizButton.className = 'btn btn-large btn-block';
                quizButton.textContent = quiz.title;
                quizButton.addEventListener('click', () => selectQuiz(quiz));
                quizList.appendChild(quizButton);
            });
        }

        // –í—ã–±–æ—Ä –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
        function selectQuiz(quiz) {
            selectedQuiz = quiz;
            document.getElementById('quiz-selection').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            
            // –°–∫—Ä—ã–≤–∞–µ–º –ø—É–ª—å—Ç —É —Ö–æ—Å—Ç–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
            if (isHost) {
                document.getElementById('remote-control').style.display = 'none';
                document.getElementById('phone-game').style.display = 'block';
            }
            
            // –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥
            currentRound = 0;
            currentQuestionIndex = 0;
            startRound();
        }

        // –ù–∞—á–∞–ª–æ —Ä–∞—É–Ω–¥–∞
        function startRound() {
            const round = selectedQuiz.rounds[currentRound];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞—É–Ω–¥–∞
            document.getElementById('round-title').textContent = `–†–∞—É–Ω–¥ ${currentRound + 1}`;
            document.getElementById('phone-round-title').textContent = `–†–∞—É–Ω–¥ ${currentRound + 1}`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
            showQuestion(round.questions[currentQuestionIndex]);
        }

        // –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞
        function showQuestion(question) {
            currentQuestion = question;
            answerSubmitted = false;
            plusTwoActive = false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
            document.getElementById('question-text').textContent = question.question;
            document.getElementById('phone-question-text').textContent = question.question;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
            document.getElementById('phone-answer-status').innerHTML = '';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
            timeLeft = question.time;
            updateTimer();
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤
            document.getElementById('answers-container').innerHTML = '';
            document.getElementById('phone-answers-container').innerHTML = '';
            document.getElementById('phone-text-answer-container').style.display = 'none';
            document.getElementById('correct-answer').style.display = 'none';
            document.getElementById('next-question-btn').style.display = 'none';
            
            // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            if (selectedQuiz.rounds[currentRound].type === 'multiple-choice') {
                showMultipleChoiceQuestion(question);
            } else if (selectedQuiz.rounds[currentRound].type === 'ordering') {
                showOrderingQuestion(question);
            } else if (selectedQuiz.rounds[currentRound].type === 'text-answer') {
                showTextAnswerQuestion(question);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);
        }

        // –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞ —Å –≤—ã–±–æ—Ä–æ–º –æ—Ç–≤–µ—Ç–∞
        function showMultipleChoiceQuestion(question) {
            const answersContainer = document.getElementById('answers-container');
            const phoneAnswersContainer = document.getElementById('phone-answers-container');
            
            question.answers.forEach((answer, index) => {
                // –î–ª—è —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞
                const answerOption = document.createElement('div');
                answerOption.className = 'answer-option';
                answerOption.textContent = answer;
                answerOption.dataset.index = index;
                answersContainer.appendChild(answerOption);
                
                // –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
                const phoneAnswerOption = document.createElement('div');
                phoneAnswerOption.className = 'answer-option';
                phoneAnswerOption.textContent = answer;
                phoneAnswerOption.dataset.index = index;
                phoneAnswerOption.addEventListener('click', () => selectAnswer(index));
                phoneAnswersContainer.appendChild(phoneAnswerOption);
            });
        }

        // –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞ —Å —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ–º
        function showOrderingQuestion(question) {
            const answersContainer = document.getElementById('answers-container');
            const phoneAnswersContainer = document.getElementById('phone-answers-container');
            
            // –î–ª—è —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞
            const orderContainer = document.createElement('div');
            orderContainer.className = 'order-answers';
            orderContainer.id = 'order-container';
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã
            const shuffledAnswers = [...question.answers];
            shuffleArray(shuffledAnswers);
            
            shuffledAnswers.forEach((answer, index) => {
                const orderItem = document.createElement('div');
                orderItem.className = 'order-item';
                orderItem.textContent = answer;
                orderItem.dataset.index = index;
                orderItem.draggable = true;
                
                orderItem.addEventListener('dragstart', handleDragStart);
                orderItem.addEventListener('dragover', handleDragOver);
                orderItem.addEventListener('drop', handleDrop);
                orderItem.addEventListener('dragend', handleDragEnd);
                
                orderContainer.appendChild(orderItem);
            });
            
            answersContainer.appendChild(orderContainer);
            
            // –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            const phoneOrderContainer = document.createElement('div');
            phoneOrderContainer.className = 'order-answers';
            phoneOrderContainer.id = 'phone-order-container';
            
            shuffledAnswers.forEach((answer, index) => {
                const phoneOrderItem = document.createElement('div');
                phoneOrderItem.className = 'order-item';
                phoneOrderItem.textContent = answer;
                phoneOrderItem.dataset.index = index;
                phoneOrderItem.draggable = true;
                
                phoneOrderItem.addEventListener('dragstart', handleDragStart);
                phoneOrderItem.addEventListener('dragover', handleDragOver);
                phoneOrderItem.addEventListener('drop', handleDrop);
                phoneOrderItem.addEventListener('dragend', handleDragEnd);
                
                phoneOrderContainer.appendChild(phoneOrderItem);
            });
            
            phoneAnswersContainer.appendChild(phoneOrderContainer);
        }

        // –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –æ—Ç–≤–µ—Ç–æ–º
        function showTextAnswerQuestion(question) {
            document.getElementById('phone-text-answer-container').style.display = 'block';
            document.getElementById('phone-plus-two').classList.remove('active');
        }

        // –í—ã–±–æ—Ä –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
        function selectAnswer(index) {
            if (answerSubmitted) return;
            
            selectedAnswer = index;
            answerSubmitted = true;
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
            const answerOptions = document.querySelectorAll('#phone-answers-container .answer-option');
            answerOptions.forEach(option => option.classList.remove('selected'));
            answerOptions[index].classList.add('selected');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∏–º–∏—Ç–∞—Ü–∏—è)
            submitAnswer();
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
        function submitTextAnswer() {
            if (answerSubmitted) return;
            
            const answer = document.getElementById('phone-text-answer').value.trim();
            if (!answer) {
                alert("–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç");
                return;
            }
            
            selectedAnswer = answer;
            answerSubmitted = true;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∏–º–∏—Ç–∞—Ü–∏—è)
            submitAnswer();
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ +2
        function togglePlusTwo() {
            plusTwoActive = !plusTwoActive;
            document.getElementById('phone-plus-two').classList.toggle('active', plusTwoActive);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function submitAnswer() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            console.log("–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:", selectedAnswer);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ç–ø—Ä–∞–≤–∫–∏
            document.getElementById('phone-answer-status').innerHTML = '<div class="card" style="background: var(--info);">–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!</div>';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
        function updateTimer() {
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('phone-timer').textContent = timeLeft;
            
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                endQuestion();
                return;
            }
            
            timeLeft--;
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
        function endQuestion() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–µ
            if (selectedQuiz.rounds[currentRound].type === 'multiple-choice') {
                const correctIndex = currentQuestion.correct;
                const answerOptions = document.querySelectorAll('#answers-container .answer-option');
                answerOptions[correctIndex].classList.add('correct');
                
                document.getElementById('correct-answer-text').textContent = currentQuestion.answers[correctIndex];
                document.getElementById('correct-answer').style.display = 'block';
            } else if (selectedQuiz.rounds[currentRound].type === 'ordering') {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
                const correctOrder = currentQuestion.correctOrder;
                const answers = currentQuestion.answers;
                
                let correctAnswerText = '';
                correctOrder.forEach(index => {
                    correctAnswerText += answers[index] + ' ‚Üí ';
                });
                correctAnswerText = correctAnswerText.slice(0, -3);
                
                document.getElementById('correct-answer-text').textContent = correctAnswerText;
                document.getElementById('correct-answer').style.display = 'block';
            } else if (selectedQuiz.rounds[currentRound].type === 'text-answer') {
                document.getElementById('correct-answer-text').textContent = currentQuestion.correctAnswer;
                document.getElementById('correct-answer').style.display = 'block';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å" —É —Ö–æ—Å—Ç–∞
            if (isHost) {
                document.getElementById('next-question-btn').style.display = 'block';
            }
            
            // –ù–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏ (–∏–º–∏—Ç–∞—Ü–∏—è)
            calculateScores();
        }

        // –†–∞—Å—á–µ—Ç –æ—á–∫–æ–≤
        function calculateScores() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞—Å—á–µ—Ç –æ—á–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –æ—á–∫–∏
            Object.keys(players).forEach(playerId => {
                const points = selectedQuiz.rounds[currentRound].type === 'multiple-choice' ? 1 : 
                              selectedQuiz.rounds[currentRound].type === 'ordering' ? 2 : 3;
                
                players[playerId].score += points;
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
            document.getElementById('phone-player-score').textContent = players[playerId].score;
        }

        // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        function nextQuestion() {
            const round = selectedQuiz.rounds[currentRound];
            currentQuestionIndex++;
            
            if (currentQuestionIndex < round.questions.length) {
                showQuestion(round.questions[currentQuestionIndex]);
            } else {
                currentRound++;
                if (currentRound < selectedQuiz.rounds.length) {
                    currentQuestionIndex = 0;
                    startRound();
                } else {
                    showResults();
                }
            }
        }

        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function showResults() {
            document.getElementById('game-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'block';
            document.getElementById('phone-game').style.display = 'none';
            document.getElementById('phone-results').style.display = 'block';
            
            // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const resultsTable = document.getElementById('results-table');
            const phoneResultsTable = document.getElementById('phone-results-table');
            
            resultsTable.innerHTML = '';
            phoneResultsTable.innerHTML = '';
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º
            const sortedPlayers = Object.values(players).sort((a, b) => b.score - a.score);
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th>';
            resultsTable.appendChild(headerRow);
            phoneResultsTable.appendChild(headerRow.cloneNode(true));
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            sortedPlayers.forEach((player, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${index + 1}</td><td>${player.name}</td><td>${player.score}</td>`;
                resultsTable.appendChild(row);
                phoneResultsTable.appendChild(row.cloneNode(true));
            });
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            if (sortedPlayers[0].id === playerId) {
                createConfetti();
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        function createConfetti() {
            const colors = ['#4361ee', '#3f37c9', '#4cc9f0', '#f72585', '#f8961e', '#4895ef'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 10 + 5 + 'px';
                confetti.style.animationDuration = Math.random() * 3 + 2 + 's';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                
                document.body.appendChild(confetti);
                
                // –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // –°–±—Ä–æ—Å –∏–≥—Ä—ã
        function resetGame() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            currentRound = 0;
            currentQuestionIndex = 0;
            playerScore = 0;
            selectedQuiz = null;
            gameState = 'waiting';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—á–∫–∏ –∏–≥—Ä–æ–∫–æ–≤
            Object.keys(players).forEach(playerId => {
                players[playerId].score = 0;
            });
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É
            document.getElementById('results-screen').style.display = 'none';
            document.getElementById('room-creation').style.display = 'block';
            document.getElementById('phone-results').style.display = 'none';
            document.getElementById('phone-connect').style.display = 'block';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
            document.getElementById('phone-player-score').textContent = '0';
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—É–ª—å—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function startQuizFromRemote() {
            startQuiz();
        }

        function nextQuestionFromRemote() {
            nextQuestion();
        }

        function showResultsFromRemote() {
            showResults();
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è (–¥–ª—è —Ä–∞—É–Ω–¥–∞ —Å —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ–º)
        let dragSrcEl = null;

        function handleDragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
            this.classList.add('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            if (dragSrcEl !== this) {
                dragSrcEl.innerHTML = this.innerHTML;
                this.innerHTML = e.dataTransfer.getData('text/html');
            }
            
            return false;
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
        }
    </script>
</body>
</html>